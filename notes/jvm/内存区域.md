# 内存区域(运行时数据区)

### 内存区域划分

#### 概括
- 堆
- 元空间(1.6及之前叫方法区)
- 虚拟机栈
- 本地方法栈
- 程序计数器


#### 程序计数器(PC寄存器)
- 较小的一块内存空间，可以看作是当前线程所执行的字节码的行号指示器。用来存储指向下一条指令的地址，即将执行的指令代码，由执行引擎读取下一条指令。
- 程序计数器的作用
    1. 字节码解释器通过改变程序计数器来依次读取指令，从而实现代码的流程控制：顺序执行、选择、循环、异常处理。
    2. 多线程环境中，程序计数器记录当前线程执行的位置，下次执行的时候能够继续执行。
- PC寄存器为什么线程私有？
    多线程在一个特定时间内只会执行其中某一个线程方法，CPU会不停的做任务切换，这样必然会导致经常中断和恢复。为了能够准确记录当前线程的执行位置，为每个线程分配一个PC寄存器，每个线程独立计算，不会相互影响。


- Java虚拟机栈
    - 栈帧:操作数栈，动态链接，方法返回地址，局部变量表
    - 局部变量表
    - 方法或函数如何调用

<br>

- 本地方法栈
    - 栈帧

<br> 

- 堆

<br>

- 方法区
    - 为什么将永生代替换为元空间
    - 运行时常量池

<br>

- 直接内存

<br>

- Java对象的创建过程
    - 类加载检查
    - 分配内存
        - 内存分配的两种方式
        - 内存分配并发问题
    - 初始化零值
    - 设置对象头
    - 执行init方法

<br>

- 对象的内存布局

<br>

- 对象的访问定位有哪两种方式？
    - 使用句柄
    - 直接指针

- String类和常量池